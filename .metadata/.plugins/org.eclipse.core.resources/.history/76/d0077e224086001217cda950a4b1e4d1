
import pymongo
import sys

def find():
    # establish a connection to the database
    connection = pymongo.Connection("mongodb://localhost", safe=True)
    # get a handle to the school database
    db=connection.test
    images = db.images
    albums = db.albums

    print "find, reporting for duty"
    try:
        parented = []
        orphans = []
        for image in images.find():
            delete = True
            for album in albums.find():
                if image['_id'] in album['images']:
                    delete = False
            if delete == True:
                orphans.append(image)
            else:
                parented.append(image)
        
        print 'Total'
        print images.find().size
        print 'Orphans'
        print orphans.size
        print 'Parented'
        print parented.size
            
            
    except:
        print "Unexpected error:", sys.exc_info()[0]

find()