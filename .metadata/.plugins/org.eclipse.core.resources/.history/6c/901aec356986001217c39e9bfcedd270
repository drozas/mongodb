
import pymongo
import sys

def find():
    # establish a connection to the database
    connection = pymongo.Connection("mongodb://localhost", safe=True)
    # get a handle to the school database
    db=connection.enron
    messages = db.messages

    print "find, reporting for duty"
    try:

        for m in messages.find(None, {"headers.From":True,"headers.To":True,"_id":True}):
            print m
            m['headers']['To'] = set(m['headers']['To'])
            #print m['headers']['To']
            
            
    except:
        print "Unexpected error:", sys.exc_info()[0]

find()